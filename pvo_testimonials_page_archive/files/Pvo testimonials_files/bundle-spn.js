// @license magnet:?xt=urn:btih:0b31508aeb0634b347b8270c7bee4d411b5d4109&dn=agpl-3.0.txt AGPL-3.0
!function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}({0:function(e,t,n){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function i(e){var t="function"==typeof Map?new Map:void 0;return(i=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,s)}function s(){return a(e,arguments,l(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),u(s,e)})(e)}function a(e,t,n){return(a=c()?Reflect.construct:function(e,t,n){var s=[null];s.push.apply(s,t);var o=new(Function.bind.apply(e,s));return n&&u(o,n.prototype),o}).apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}if(n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return m})),"undefiend"!=typeof window.XMLHttpRequest){var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(s,e);var t,n=(t=s,function(){var e,n=l(t);if(c()){var s=l(this).constructor;e=Reflect.construct(n,arguments,s)}else e=n.apply(this,arguments);return r(this,e)});function s(){return o(this,s),n.apply(this,arguments)}return s}(i(XMLHttpRequest));Object.defineProperty(p.prototype,"responseURL",Object.getOwnPropertyDescriptor(XMLHttpRequest.prototype,"responseURL"))}function f(e,t,n,s,o){var r;if((r=window.XMLHttpRequest?new p:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){4==this.readyState&&n(r)},r.open(e,t,!0),s)for(var i in s)s.hasOwnProperty(i)&&r.setRequestHeader(i,s[i]);r.withCredentials=!0,r.send(o)}function d(e){return void 0!==e&&e&&e.constructor===Array}function h(e){return document.cookie.search(e)>=0}function v(e,t){var n=window["HTML".concat(e,"Element")];if(void 0!==n){var s=Object.getOwnPropertyDescriptor(n.prototype,t);void 0!==s&&Object.defineProperty(n.prototype,"_wm_".concat(t),s)}}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"src",n="_wm_".concat(t);return n in e.__proto__?e[n]:e[t]}v("Image","src"),v("Media","src"),v("Embed","src"),v("IFrame","src"),v("Script","src"),v("Link","href"),v("Anchor","href")},11:function(e,t,n){"use strict";n.r(t);var s={};n.r(s),n.d(s,"systemStatus",(function(){return v})),n.d(s,"watchJob",(function(){return m})),n.d(s,"init",(function(){return _}));var o,r=n(2),i=n(0);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return $("<div>",{id:t}).append($("<a>",{href:e}).html(e),$("<span>").html(" Saving... ").append('<img src="'.concat(p,'images/loading.gif" />')))}function u(e){var t=$("body").find("#".concat(e.job_id)).first();if("success"===e.status){var n="/web/".concat(e.timestamp,"/").concat(e.original_url);t.children("a").first().attr("href",n).html(n),t.children("span").html('<span class="label label-success" style="display:inline-block;margin-left:2px"><span class="iconochive-Done"></span> Done!</span>'),!0===e.first_archive&&t.children("span").first().append('<span class="label label-default" style="display:inline-block;margin-left:2px"><span class="iconochive-First"></span> First Archive</span>')}else"error"===e.status&&t.children("span").html("").append('<span class="label label-danger" style="display:inline-block;margin-left:2px">Error! '+e.message+"</span>")}var l,p,f,d=[];function h(e){$.post("/save/status?_t="+Date.now(),{job_id_outlinks:e},(function(t){var n,s=!1;for(var o in t){var r=t[o];u(r),"pending"===r.status?s=!0:"success"===r.status&&-1===d.indexOf(r.job_id)?(d.push(r.job_id),n=r.job_id,$.ajax({url:"/save/status/".concat(n,"?_t=").concat(Date.now()),success:function(e){if(e.outlinks&&"object"===a(e.outlinks)&&"0"!==Object.keys(e.outlinks)[0]&&Object.keys(e.outlinks).length){for(var t in e.outlinks){var n=e.outlinks[t];0===$("body").find("#"+n).length&&$("#spn-outlinks").append(c(t,n))}setTimeout((function(){h(e.job_id)}),6e3)}}})):"error"===r.status&&-1===d.indexOf(r.job_id)&&d.push(r.job_id)}!1!==s&&setTimeout((function(){h(e)}),6e3)}))}function v(){$.get("/save/status/system",(function(e){"ok"!==e.status&&$("#web_save_div").prepend('<div class="alert alert-warning">'.concat(e.status,"</div>"))}))}function m(e,t,n){l=e,p=t,f=n,o=$("#saving-msg"),Object(i.c)("logged-in-user")||$("#spn-option-mywebarchive").hide(),$("#report-issue").on("click",(function(){$.ajax({url:"/save/_report-issue/".concat(l),beforeSend:function(e){$("#report-issue-container").html('Sending info... <img src="'.concat(p,'images/loading.gif"/>'))},complete:function(e){$("#report-issue-container").html("Thank you!")}})})),w()}function y(e){var t="/web/".concat(e.timestamp,"/").concat(e.original_url);if("available"in e&&"message"in e)$("#spn-result").append($("<span>").text(e.message+" Visit page: "),$("<a>",{href:t}).html(t)),$("#spn-resources").hide(),$("#spn-option-mywebarchive").hide();else{if($("#spn-title").append($("<span>").html(" "),$("<span>",{class:"label label-success",style:"font-size: small"}).append($("<span>",{class:"iconochive-Done"}),$("<span>").html(" Done!"))),"first_archive"in e&&$("#spn-title").append($("<span>").html(" "),$("<span>",{class:"label label-default",style:"font-size: small"}).append($("<span>",{class:"iconochive-First"}),$("<span>").html(" First Archive "))),$("#spn-result").append($("<span>").html(" A snapshot was captured. Visit page: ").append($("<a>",{href:t}).html(t))),"screenshot"in e){var n="/web/".concat(e.timestamp,"/").concat(e.screenshot);$("#spn-result").append($("<div>").html("A screen shot was captured. View screen shot: ").append($("<a>",{href:n}).html(n)))}if("www.youtube.com"===new URL(e.original_url).hostname&&$("#spn-result").append("<div>It may take a few days for YouTube videos to become available for playback.</div>"),"undefined"!==e.resources&&0!==e.resources.length||$("#spn-resources").hide(),e.outlinks&&"object"===a(e.outlinks)&&"0"!==Object.keys(e.outlinks)[0]&&Object.keys(e.outlinks).length){for(var s in $("#spn-outlinks").append("<strong>Saving outlinks and their embedded resources</strong><br />"),e.outlinks)$("#spn-outlinks").append(c(s,e.outlinks[s]));h(l)}$("<div>",{class:"text-center"}).append($("<a>",{href:"/save"}).html("Return to Save Page Now")).insertAfter("#spn-outlinks"),Object(i.c)("logged-in-user")&&Object(i.c)("logged-in-sig")&&$("#wm-save-mywebarchive")[0].checked?(Object(r.b)(e.original_url,e.timestamp),$("#wm-save-snapshot-success").show(),$("#spn-option-mywebarchive").delay(2e3).hide(0)):$("#spn-option-mywebarchive").hide(0)}o.html("")}var b=0;function g(e){if(5===(b+=1))return y(e),void function(e){$("#spn-result").append("<div>There was a delay in registering this snapshot with the Wayback Machine.</div>"),"first_archive"in e?$("#spn-result").append("<div>The snapshot may not be available right now, please try again later.</div>"):$("#spn-result").append("<div>You may be redirected to a previous version right now. This snapshot will be available later.</div>")}(e);$.ajax({url:"/web/timemap/",data:{url:e.original_url,from:e.timestamp,limit:1,_t:Date.now()},success:function(t){""!==t&&void 0!==t?y(e):setTimeout((function(){g(e)}),f)},error:function(){setTimeout((function(){g(e)}),f)}})}function w(){$.ajax({url:"/save/status/".concat(l,"?_t=").concat(Date.now()),beforeSend:function(e){""===o.html()&&o.append("Saving... ",'<img src="'.concat(p,'images/loading.gif"/>'))},success:function(e){if(e.resources){var t=e.resources.length;t>0&&($("#spn-elements-counter-container").show(),$("#spn-elements-counter").html(t));var n=e.resources.join("\n");""!=n&&$("#spn-resources").val(n)}if(e.download_size){var s=Math.round(e.download_size/e.total_size*100),r=function(e){var t=-1;do{e/=1024,t++}while(e>1024);return Math.max(e,.1).toFixed(1)+[" kB"," MB"," GB"][t]}(e.download_size);s>0&&(r+=" ("+s.toString()+"%)"),$("#spn-progress").show(),$("#spn-progress > div.progress-bar").attr("style","width: "+s.toString()+"%").attr("aria-valuenow",s).text(r)}var i;"success"===e.status?setTimeout((function(){g(e)}),f):"error"===e.status?(void 0===(i=e.message)&&(i="Internal server error."),o.html(""),$("#spn-result").append($("<p>",{class:"text-danger"}).html(i),$("<a>",{href:"/save"}).html("Return to Save Page Now")),$("#spn-resources").hide()):setTimeout(w,f)},error:function(){setTimeout(w,f)}})}function _(){$("#web-save-form").on("submit",(function(e){e.preventDefault();var t=$("#web-save-url-input").val(),n=$("#web-save-form")[0];$(n).attr("action","/save/"+t),n.submit()})),$(document).ready((function(){document.cookie.search("logged-in-user")>=0&&document.cookie.search("logged-in-sig")>=0&&($("#wm-save-option, #wm-capture-screenshot, #wm-capture-outlinks, #wm-email-result").show(),$("#wm-auth-features").hide())}))}window.spn=s},2:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var s=n(0);function o(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var r=JSON;function i(e,t,n,o){return o=o||{},Object(s.a)("POST","/__wb/web-archive/",(function(e){401===e.status?o.userNotLoggedIn&&o.userNotLoggedIn(e):e.status>=400?o.failure&&o.failure(e):o.success&&o.success(e)}),{"Content-Type":"application/json"},r.stringify({url:e,snapshot:t,tags:n||[]})),!1}var a=function(){function e(t,n,o){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=t,this.url=n,this.timestamp=o,t.onclick=this.save.bind(this),document.addEventListener("DOMContentLoaded",(function(){Object(s.c)("logged-in-user")&&Object(s.c)("logged-in-sig")?r.userIsLoggedIn():r.userIsNotLoggedIn()}))}var t,n,r;return t=e,(n=[{key:"save",value:function(e){this.start(),i(this.url,this.timestamp,[],{failure:this.failure.bind(this),success:this.success.bind(this)})}},{key:"start",value:function(){this.hide(["wm-save-snapshot-fail","wm-save-snapshot-open","wm-save-snapshot-success"]),this.show(["wm-save-snapshot-in-progress"])}},{key:"failure",value:function(e){401==e.status?this.userNotLoggedIn(e):(this.hide(["wm-save-snapshot-in-progress","wm-save-snapshot-success"]),this.show(["wm-save-snapshot-fail","wm-save-snapshot-open"]),console.log("You have got an error."),console.log("If you think something wrong here please send it to support."),console.log('Response: "'+e.responseText+'"'),console.log('status: "'+e.status+'"'))}},{key:"success",value:function(e){this.hide(["wm-save-snapshot-fail","wm-save-snapshot-in-progress"]),this.show(["wm-save-snapshot-open","wm-save-snapshot-success"])}},{key:"userIsLoggedIn",value:function(){this.show("wm-save-snapshot-open"),this.hide("wm-sign-in")}},{key:"userIsNotLoggedIn",value:function(){this.hide(["wm-save-snapshot-open","wm-save-snapshot-in-progress"]),this.show("wm-sign-in")}},{key:"show",value:function(e){this.setDisplayStyle(e,"inline-block")}},{key:"hide",value:function(e){this.setDisplayStyle(e,"none")}},{key:"setDisplayStyle",value:function(e,t){var n=this;(Object(s.d)(e)?e:[e]).forEach((function(e){var s=n.el.getRootNode().getElementById(e);s&&(s.style.display=t)}))}}])&&o(t.prototype,n),r&&o(t,r),e}()}});
// @license-end
